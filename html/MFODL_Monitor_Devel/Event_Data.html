<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Event_Data</title>
</head>


<body>
<div class="head">
<h1>Theory Event_Data</h1>
</div>

<pre class="source"><span class="comment1">(*&lt;*)</span>
<span class="keyword1"><span class="command">theory</span></span> Event_Data
  <span class="keyword2"><span class="keyword">imports</span></span>
    <span class="quoted">"<a href="../../HOL/HOL-Library/Char_ord.html">HOL-Library.Char_ord</a>"</span>
    <a href="Code_Double.html">Code_Double</a>
    <a href="../Deriving/Derive.html">Deriving.Derive</a>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="comment1">(*&gt;*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Code adaptation for 8-bit strings›</span></span>

<span class="keyword1"><span class="command">typedef</span></span> string8 <span class="main">=</span> <span class="quoted"><span class="quoted">"UNIV <span class="main">::</span> char list set"</span></span> <span class="keyword1"><span class="command">..</span></span>

<span class="keyword1"><span class="command">setup_lifting</span></span> type_definition_string8

<span class="keyword1"><span class="command">lift_definition</span></span> string8_literal <span class="main">::</span> <span class="quoted"><span class="quoted">"String.literal <span class="main">⇒</span> string8"</span></span> <span class="keyword2"><span class="keyword">is</span></span> <span class="quoted">String.explode</span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">declare</span></span> <span class="main">[</span><span class="main">[</span><span class="operator">coercion</span> <span class="quoted">string8_literal</span><span class="main">]</span><span class="main">]</span>

<span class="keyword1"><span class="command">instantiation</span></span> string8 <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">{</span>equal<span class="main">,</span> linorder<span class="main">}</span>"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">lift_definition</span></span> <span class="class_parameter">equal_string8</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"string8 <span class="main">⇒</span> string8 <span class="main">⇒</span> bool"</span></span> <span class="keyword2"><span class="keyword">is</span></span> <span class="quoted">HOL.equal</span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">lift_definition</span></span> <span class="class_parameter">less_eq_string8</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"string8 <span class="main">⇒</span> string8 <span class="main">⇒</span> bool"</span></span> <span class="keyword2"><span class="keyword">is</span></span> <span class="quoted">ord_class.lexordp_eq</span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">lift_definition</span></span> <span class="class_parameter">less_string8</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"string8 <span class="main">⇒</span> string8 <span class="main">⇒</span> bool"</span></span> <span class="keyword2"><span class="keyword">is</span></span> <span class="quoted">ord_class.lexordp</span> <span class="keyword1"><span class="command">.</span></span>

<span class="keyword1"><span class="command">instance</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">intro_classes</span>
    <span class="main">(</span><span class="operator">transfer</span><span class="main"><span class="keyword3">;</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> equal_eq lexordp_conv_lexordp_eq lexordp_eq_linear
      <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> lexordp_eq_refl lexordp_eq_trans lexordp_eq_antisym<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">lifting_forget</span></span> string8.lifting

<span class="keyword1"><span class="command">declare</span></span> <span class="main">[</span><span class="main">[</span><span class="operator">code</span> <span class="quasi_keyword">drop</span><span class="main"><span class="main">:</span></span> <span class="quoted">string8_literal</span> <span class="quoted"><span class="quoted">"HOL.equal <span class="main">::</span> string8 <span class="main">⇒</span> <span class="main">_</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="main">(≤)</span> <span class="main">::</span> string8 <span class="main">⇒</span> <span class="main">_</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">(&lt;)</span> <span class="main">::</span> string8 <span class="main">⇒</span> <span class="main">_</span>"</span></span>
      <span class="quoted"><span class="quoted">"Code_Evaluation.term_of <span class="main">::</span> string8 <span class="main">⇒</span> <span class="main">_</span>"</span></span><span class="main">]</span><span class="main">]</span>

<span class="keyword1"><span class="command">code_printing</span></span>
  <span class="keyword2"><span class="keyword">type_constructor</span></span> string8 <span class="main">⇀</span> <span class="main">(</span>OCaml<span class="main">)</span> <span class="quoted">"string"</span>
  <span class="main">|</span> <span class="keyword2"><span class="keyword">constant</span></span> <span class="quoted"><span class="quoted">"HOL.equal <span class="main">::</span> string8 <span class="main">⇒</span> string8 <span class="main">⇒</span> bool"</span></span> <span class="main">⇀</span> <span class="main">(</span>OCaml<span class="main">)</span> <span class="quoted">"Stdlib.(=)"</span>
  <span class="main">|</span> <span class="keyword2"><span class="keyword">constant</span></span> <span class="quoted"><span class="quoted">"<span class="main">(≤)</span> <span class="main">::</span> string8 <span class="main">⇒</span> string8 <span class="main">⇒</span> bool"</span></span> <span class="main">⇀</span> <span class="main">(</span>OCaml<span class="main">)</span> <span class="quoted">"Stdlib.(&lt;=)"</span>
  <span class="main">|</span> <span class="keyword2"><span class="keyword">constant</span></span> <span class="quoted"><span class="quoted">"<span class="main">(&lt;)</span> <span class="main">::</span> string8 <span class="main">⇒</span> string8 <span class="main">⇒</span> bool"</span></span> <span class="main">⇀</span> <span class="main">(</span>OCaml<span class="main">)</span> <span class="quoted">"Stdlib.(&lt;)"</span>

<span class="keyword1"><span class="command">ML</span></span> <span class="quoted">‹
<span class="keyword1"><span class="keyword">structure</span></span> <span class="entity">String8</span> <span class="main">=</span>
<span class="keyword2"><span class="keyword">struct</span></span>
  <span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">to_term</span> <span class="entity">x</span> <span class="main">=</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">Abs_string8</span><span class="antiquote">}</span></span> $ <span class="entity">HOLogic.mk_string</span> <span class="entity">x</span><span class="main">;</span>
<span class="keyword2"><span class="keyword">end</span></span><span class="main">;</span>
›</span>

<span class="keyword1"><span class="command">code_printing</span></span>
  <span class="keyword2"><span class="keyword">type_constructor</span></span> string8 <span class="main">⇀</span> <span class="main">(</span>Eval<span class="main">)</span> <span class="quoted">"string"</span>
  <span class="main">|</span> <span class="keyword2"><span class="keyword">constant</span></span> <span class="quoted"><span class="quoted">"string8_literal <span class="main">::</span> String.literal <span class="main">⇒</span> string8"</span></span> <span class="main">⇀</span> <span class="main">(</span>Eval<span class="main">)</span> <span class="quoted">"_"</span>
  <span class="main">|</span> <span class="keyword2"><span class="keyword">constant</span></span> <span class="quoted"><span class="quoted">"HOL.equal <span class="main">::</span> string8 <span class="main">⇒</span> string8 <span class="main">⇒</span> bool"</span></span> <span class="main">⇀</span> <span class="main">(</span>Eval<span class="main">)</span> <span class="keyword2"><span class="keyword">infixl</span></span> 6 <span class="quoted">"="</span>
  <span class="main">|</span> <span class="keyword2"><span class="keyword">constant</span></span> <span class="quoted"><span class="quoted">"<span class="main">(≤)</span> <span class="main">::</span> string8 <span class="main">⇒</span> string8 <span class="main">⇒</span> bool"</span></span> <span class="main">⇀</span> <span class="main">(</span>Eval<span class="main">)</span> <span class="keyword2"><span class="keyword">infixl</span></span> 6 <span class="quoted">"&lt;="</span>
  <span class="main">|</span> <span class="keyword2"><span class="keyword">constant</span></span> <span class="quoted"><span class="quoted">"<span class="main">(&lt;)</span> <span class="main">::</span> string8 <span class="main">⇒</span> string8 <span class="main">⇒</span> bool"</span></span> <span class="main">⇀</span> <span class="main">(</span>Eval<span class="main">)</span> <span class="keyword2"><span class="keyword">infixl</span></span> 6 <span class="quoted">"&lt;"</span>
  <span class="main">|</span> <span class="keyword2"><span class="keyword">constant</span></span> <span class="quoted"><span class="quoted">"Code_Evaluation.term_of <span class="main">::</span> string8 <span class="main">⇒</span> term"</span></span> <span class="main">⇀</span> <span class="main">(</span>Eval<span class="main">)</span> <span class="quoted">"String8.to'_term"</span>

<span class="keyword1"><span class="command">derive</span></span> <span class="main">(</span>eq<span class="main">)</span> ceq <span class="quoted">string8</span>
<span class="keyword1"><span class="command">derive</span></span> <span class="main">(</span>linorder<span class="main">)</span> compare <span class="quoted">string8</span>
<span class="keyword1"><span class="command">derive</span></span> <span class="main">(</span>compare<span class="main">)</span> ccompare <span class="quoted">string8</span>


<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Event parameters›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">div_to_zero</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"integer <span class="main">⇒</span> integer <span class="main">⇒</span> integer"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">div_to_zero</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">let</span> <span class="bound">z</span> <span class="main">=</span> fst <span class="main">(</span>Code_Numeral.divmod_abs <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span> <span class="keyword1">in</span>
    <span class="keyword1">if</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">&lt;</span> <span class="main">0</span><span class="main">)</span> <span class="main">≠</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">&lt;</span> <span class="main">0</span><span class="main">)</span> <span class="keyword1">then</span> <span class="main">-</span> <span class="bound">z</span> <span class="keyword1">else</span> <span class="bound">z</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">mod_to_zero</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"integer <span class="main">⇒</span> integer <span class="main">⇒</span> integer"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">mod_to_zero</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">let</span> <span class="bound">z</span> <span class="main">=</span> snd <span class="main">(</span>Code_Numeral.divmod_abs <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span> <span class="keyword1">in</span>
    <span class="keyword1">if</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">&lt;</span> <span class="main">0</span> <span class="keyword1">then</span> <span class="main">-</span> <span class="bound">z</span> <span class="keyword1">else</span> <span class="bound">z</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">⟹</span> div_to_zero <span class="free">a</span> <span class="free">b</span> <span class="main">*</span> <span class="free">b</span> <span class="main">+</span> mod_to_zero <span class="free">a</span> <span class="free">b</span> <span class="main">=</span> <span class="free">a</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> div_to_zero_def mod_to_zero_def Let_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> minus_mod_eq_mult_div<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span> div_minus_right mod_minus_right <span class="dynamic"><span class="dynamic">ac_simps</span></span><span class="main">)</span>


<span class="keyword1"><span class="command">datatype</span></span> event_data <span class="main">=</span> EInt <span class="quoted">integer</span> <span class="main">|</span> EFloat <span class="quoted">double</span> <span class="main">|</span> EString <span class="quoted">string8</span>

<span class="keyword1"><span class="command">derive</span></span> <span class="main">(</span>eq<span class="main">)</span> ceq <span class="quoted">event_data</span>
<span class="keyword1"><span class="command">derive</span></span> ccompare <span class="quoted">event_data</span>

<span class="keyword1"><span class="command">instantiation</span></span> event_data <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">{</span>ord<span class="main">,</span> plus<span class="main">,</span> minus<span class="main">,</span> uminus<span class="main">,</span> times<span class="main">,</span> divide<span class="main">,</span> modulo<span class="main">}</span>"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity"><span class="class_parameter">less_eq_event_data</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"EInt <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≤</span> EInt <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">⟷</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≤</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"EInt <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≤</span> EFloat <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">⟷</span> double_of_integer <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≤</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"EInt <span class="main"><span class="bound"><span class="entity">_</span></span></span> <span class="main">≤</span> EString <span class="main"><span class="bound"><span class="entity">_</span></span></span> <span class="main">⟷</span> False"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"EFloat <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≤</span> EInt <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">⟷</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≤</span> double_of_integer <span class="free"><span class="bound"><span class="entity">y</span></span></span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"EFloat <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≤</span> EFloat <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">⟷</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≤</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"EFloat <span class="main"><span class="bound"><span class="entity">_</span></span></span> <span class="main">≤</span> EString <span class="main"><span class="bound"><span class="entity">_</span></span></span> <span class="main">⟷</span> False"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"EString <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≤</span> EString <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">⟷</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≤</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"EString <span class="main"><span class="bound"><span class="entity">_</span></span></span> <span class="main">≤</span> <span class="main"><span class="bound"><span class="entity">_</span></span></span> <span class="main">⟷</span> False"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity"><span class="class_parameter">less_event_data</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">"event_data <span class="main">⇒</span> event_data <span class="main">⇒</span> bool"</span></span>  <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">less_event_data</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">⟷</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≤</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">∧</span> <span class="main">¬</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">≤</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity"><span class="class_parameter">plus_event_data</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"EInt <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">+</span> EInt <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">=</span> EInt <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">+</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"EInt <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">+</span> EFloat <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">=</span> EFloat <span class="main">(</span>double_of_integer <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">+</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"EFloat <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">+</span> EInt <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">=</span> EFloat <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">+</span> double_of_integer <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"EFloat <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">+</span> EFloat <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">=</span> EFloat <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">+</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="bound"><span class="entity">_</span></span></span><span class="main">::</span>event_data<span class="main">)</span> <span class="main">+</span> <span class="main"><span class="bound"><span class="entity">_</span></span></span> <span class="main">=</span> EFloat nan"</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity"><span class="class_parameter">minus_event_data</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"EInt <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">-</span> EInt <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">=</span> EInt <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">-</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"EInt <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">-</span> EFloat <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">=</span> EFloat <span class="main">(</span>double_of_integer <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">-</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"EFloat <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">-</span> EInt <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">=</span> EFloat <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">-</span> double_of_integer <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"EFloat <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">-</span> EFloat <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">=</span> EFloat <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">-</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="bound"><span class="entity">_</span></span></span><span class="main">::</span>event_data<span class="main">)</span> <span class="main">-</span> <span class="main"><span class="bound"><span class="entity">_</span></span></span> <span class="main">=</span> EFloat nan"</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity"><span class="class_parameter">uminus_event_data</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">-</span> EInt <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">=</span> EInt <span class="main">(</span><span class="main">-</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="main">-</span> EFloat <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">=</span> EFloat <span class="main">(</span><span class="main">-</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="main">-</span> <span class="main">(</span><span class="main"><span class="bound"><span class="entity">_</span></span></span><span class="main">::</span>event_data<span class="main">)</span> <span class="main">=</span> EFloat nan"</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity"><span class="class_parameter">times_event_data</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"EInt <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">*</span> EInt <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">=</span> EInt <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">*</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"EInt <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">*</span> EFloat <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">=</span> EFloat <span class="main">(</span>double_of_integer <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">*</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"EFloat <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">*</span> EInt <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">=</span> EFloat <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">*</span> double_of_integer <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"EFloat <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">*</span> EFloat <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">=</span> EFloat <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">*</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="bound"><span class="entity">_</span></span></span><span class="main">::</span>event_data<span class="main">)</span> <span class="main">*</span> <span class="main"><span class="bound"><span class="entity">_</span></span></span> <span class="main">=</span> EFloat nan"</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity"><span class="class_parameter">divide_event_data</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"EInt <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="keyword1">div</span> EInt <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">=</span> EInt <span class="main">(</span>div_to_zero <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"EInt <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="keyword1">div</span> EFloat <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">=</span> EFloat <span class="main">(</span>double_of_integer <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="keyword1">div</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"EFloat <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="keyword1">div</span> EInt <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">=</span> EFloat <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="keyword1">div</span> double_of_integer <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"EFloat <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="keyword1">div</span> EFloat <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">=</span> EFloat <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="keyword1">div</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="bound"><span class="entity">_</span></span></span><span class="main">::</span>event_data<span class="main">)</span> <span class="keyword1">div</span> <span class="main"><span class="bound"><span class="entity">_</span></span></span> <span class="main">=</span> EFloat nan"</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity"><span class="class_parameter">modulo_event_data</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"EInt <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="keyword1">mod</span> EInt <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">=</span> EInt <span class="main">(</span>mod_to_zero <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="bound"><span class="entity">_</span></span></span><span class="main">::</span>event_data<span class="main">)</span> <span class="keyword1">mod</span> <span class="main"><span class="bound"><span class="entity">_</span></span></span> <span class="main">=</span> EFloat nan"</span></span>

<span class="keyword1"><span class="command">instance</span></span> <span class="keyword1"><span class="command">..</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">primrec</span></span> <span class="entity">integer_of_event_data</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"event_data <span class="main">⇒</span> integer"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">integer_of_event_data</span> <span class="main">(</span>EInt <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">integer_of_event_data</span> <span class="main">(</span>EFloat <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">=</span> integer_of_double <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">integer_of_event_data</span> <span class="main">(</span>EString <span class="main"><span class="bound"><span class="entity">_</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>

<span class="keyword1"><span class="command">primrec</span></span> <span class="entity">double_of_event_data</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"event_data <span class="main">⇒</span> double"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">double_of_event_data</span> <span class="main">(</span>EInt <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">=</span> double_of_integer <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">double_of_event_data</span> <span class="main">(</span>EFloat <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">double_of_event_data</span> <span class="main">(</span>EString <span class="main"><span class="bound"><span class="entity">_</span></span></span><span class="main">)</span> <span class="main">=</span> nan"</span></span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword2"><span class="keyword">end</span></span>
<span class="comment1">(*&gt;*)</span>
</pre>
</body>

</html>